@model IEnumerable<ProjectWebApp.Models.PRESUPUESTO>

@{
    ViewBag.Title = "GEProcesos";
    Layout = "~/Views/Shared/_LayoutPrincipal.cshtml";
}

<!-- Large modal -->
<div class="col-md-12 col-sm-12 col-xs-12">
    <div class="x_panel">
        <div class="x_title">
            <h2>Gestion de Procesos Judiciales</h2>
            <div class="clearfix"></div>
        </div>
        <div class="x_content">
            <div id="datatable-buttons_wrapper" class="dataTables_wrapper form-inline dt-bootstrap no-footer">
                <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap dataTable no-footer dtr-inline projects" cellspacing="0" width="100%" role="grid" aria-describedby="datatable-responsive_info" style="width: 100%;">
                    <thead>
                        <tr role="row">
                            <th class="sorting" tabindex="0" aria-controls="datatable-buttons" rowspan="1" colspan="1" style="width: auto;" aria-label="Position: activate to sort column ascending">Cod Solicitud</th>
                            @*<th class="sorting" tabindex="0" aria-controls="datatable-buttons" rowspan="1" colspan="1" style="width: auto;" aria-label="Position: activate to sort column ascending">Fecha Notificacion</th>*@
                            <th class="sorting" tabindex="0" aria-controls="datatable-buttons" rowspan="1" colspan="1" style="width: auto;" aria-label="Position: activate to sort column ascending">Estado</th>
                            @*<th class="sorting_asc" tabindex="0" aria-controls="datatable-buttons" rowspan="1" colspan="1" style="width: auto;" aria-sort="ascending" aria-label="Name: activate to sort column descending">Contrato</th>*@
                            <th class="sorting_asc" tabindex="0" aria-controls="datatable-buttons" rowspan="1" colspan="1" style="width: auto;" aria-sort="ascending" aria-label="Name: activate to sort column descending">Asistente</th>
                            <th class="sorting_asc" tabindex="0" aria-controls="datatable-buttons" rowspan="1" colspan="1" style="width: auto;" aria-sort="ascending" aria-label="Name: activate to sort column descending">Causal</th>
                            <th class="sorting_asc" tabindex="0" aria-controls="datatable-buttons" rowspan="1" colspan="1" style="width: auto;" aria-sort="ascending" aria-label="Name: activate to sort column descending">Fecha Creacion</th>
                            <th class="sorting" tabindex="0" aria-controls="datatable-buttons" rowspan="1" colspan="1" style="width: 200px;" aria-label="Salary: activate to sort column ascending">Acción</th>
                        </tr>
                    </thead>


                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr ole="row" class="odd">
                                <td>
                                    @Html.DisplayFor(modelItem => item.COD_SOLICITUD)
                                </td>
                                @*<td>
                                        @Html.DisplayFor(modelItem => item.FECHA_NOTIFICA)
                                    </td>*@
                                @{string status = "";}
                                @switch (item.ESTADO_AVANCE)
                                {

                                    case "Recepcionado":
                                        status = "success";
                                        break;
                                    case "Aceptado":
                                        status = "success";
                                        break;
                                    case "Rechazado":
                                        status = "danger";
                                        break;
                                    case "Asignado":
                                        status = "primary";
                                        break;
                                    case "Firmado Contrato":
                                        status = "info";
                                        break;
                                    case "Poder Judicial":
                                        status = "info";
                                        break;
                                    case "Resolucion Judicial":
                                        status = "warning";
                                        break;
                                    case "Pagado":
                                        status = "success";
                                        break;

                                }



                                <td>
                                    <button type="button" class="btn btn-@status btn-xs">@Html.DisplayFor(modelItem => item.ESTADO_AVANCE)</button>
                                </td>
                                @*<td>
                                        @Html.DisplayFor(modelItem => item.CONTRATADO)
                                    </td>*@


                                <td>
                                    <ul class="list-inline">
                                        @if (item.ASISTENTES == null)
                                        {
                                            <li>
                                                <img src="~/assets/img/user.png" class="avatar img-circle" alt="Avatar" title="No Asignado">
                                            </li>
                                        }
                                        else
                                        {
                                            <li>
                                                <img src="data:image;base64,@System.Convert.ToBase64String(item.ASISTENTES.USUARIOS.BINARY_IMAGE)" class="avatar img-circle" alt="Avatar" title="@item.ASISTENTES.NOMBRES" /><small style="text-align:right">@item.ASISTENTES.NOMBRES</small>
                                            </li>
                                        }

                                    </ul>
                                </td>


                                <td>
                                    @Html.DisplayFor(modelItem => item.CAUSALES.NOMBRE)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.FECHA)
                                </td>
                                <td>
                                    <a href="/PRESUPUESTO/Procesos/@item.ID_PRESUPUESTO" class="btn btn-primary btn-xs"><i class="fa fa-folder"></i> Ver</a>
                                    <a href="/PRESUPUESTO/Asignaciones/@item.ID_PRESUPUESTO" class="btn btn-success btn-xs"><i class="fa fa-check"></i> Gestionar</a>
                                    <a href="" class="btn btn-danger btn-xs"><i class="fa fa-remove"></i> Rechazar</a>
                                </td>
                            </tr>
                        }

                    </tbody>
                </table>
                <div class="dataTables_paginate paging_simple_numbers" id="datatable-buttons_paginate">
                </div>
            </div>
        </div>
    </div>
</div>


@section Scripts{
    <!--DataTables-->
    <script>
        $(document).ready(function () {
            var handleDataTableButtons = function () {
                if ($("#datatable-buttons").length) {
                    $("#datatable-buttons").DataTable({
                        dom: "Bfrtip",
                        buttons: [
                            {
                                extend: "copy",
                                className: "btn-sm"
                            },
                            {
                                extend: "csv",
                                className: "btn-sm"
                            },
                            {
                                extend: "excel",
                                className: "btn-sm"
                            },
                            {
                                extend: "pdfHtml5",
                                className: "btn-sm"
                            },
                            {
                                extend: "print",
                                className: "btn-sm"
                            },
                        ],
                        responsive: true
                    });
                }
            };

            TableManageButtons = function () {
                "use strict";
                return {
                    init: function () {
                        handleDataTableButtons();
                    }
                };
            }();

            $('#datatable').dataTable();

            $('#datatable-keytable').DataTable({
                keys: true
            });

            $('#datatable-responsive').DataTable();

            $('#datatable-scroller').DataTable({
                ajax: "js/datatables/json/scroller-demo.json",
                deferRender: true,
                scrollY: 380,
                scrollCollapse: true,
                scroller: true
            });

            $('#datatable-fixed-header').DataTable({
                fixedHeader: true
            });

            var $datatable = $('#datatable-checkbox');

            $datatable.dataTable({
                'order': [[1, 'asc']],
                'columnDefs': [
                    { orderable: false, targets: [0] }
                ]
            });
            $datatable.on('draw.dt', function () {
                $('input').iCheck({
                    checkboxClass: 'icheckbox_flat-green'
                });
            });

            TableManageButtons.init();
        });
    </script>

    <!--DataTables-->
}


